(this.webpackJsonpread1000=this.webpackJsonpread1000||[]).push([[0],{123:function(e,t,n){},124:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var a=n(3),o=n.n(a),c=n(47),r=n.n(c),s=(n(123),n(13)),l=(n(124),n(100)),i=n(106),d=n(29),u=n(51),j=n(48),b=Object(l.a)({apiKey:"AIzaSyCGerFrxYZ2_MfRCURUdsqMuD2-9V-B7g4",authDomain:"readbooks-164200.firebaseapp.com",databaseURL:"https://readbooks-164200.firebaseio.com",projectId:"readbooks-164200",storageBucket:"readbooks-164200.appspot.com",messagingSenderId:"451518411017",appId:"1:451518411017:web:cced9b89a6030da16963d8",measurementId:"G-8WQD7EGSVQ"}),g=(Object(i.a)(b),Object(d.c)(b)),O=Object(u.b)(b),h=Object(j.b)(b),f=new u.a,p="sign-in",m="user-rank-daily",x="user-rank-weekly",v="user-rank-monthly",k="good-writer",w="famous-book",y="recent-review",I="best-reader",_="change-mode",S="user-rank-data-received",R=o.a.createContext({}),C={mode:"init",userRankList:null},M=function(e,t){var n;switch(console.log("reducer called~!",e,t),t.type){case _:n=Object.assign({},e,{mode:t.mode});break;case S:n=Object.assign({},e,{userRankList:t.userRankList});break;default:n=C}return console.log("reducer return ===>",n),n},L=n(191),D=n(7),B=function(){var e=Object(a.useContext)(R),t=e.state,n=e.dispatch;console.log("Signin state=>",t);var o=t.mode;return console.log("signin render()",o),o!==p?(console.log("signin hidden return"),Object(D.jsx)("div",{className:"hidden"})):(console.log("signin general return"),Object(D.jsxs)("div",{children:[Object(D.jsx)("h1",{children:"Sign in screen"}),Object(D.jsx)(L.a,{onClick:function(){!function(e){Object(u.c)(O,f).then((function(t){var n=u.a.credentialFromResult(t).accessToken,a=t.user;console.log("\ub85c\uadf8\uc778 \uc644\ub8cc~!!",a,n),e({type:_,mode:m})})).catch((function(e){var t=e.code,n=e.message,a=e.email,o=u.a.credentialFromError(e);console.log("error=>",t,n,a,o),console.log("\ub85c\uadf8\uc778 \uc2e4\ud328~!!")}))}(n)},children:"Google \ub85c \ub85c\uadf8\uc778"})]}))},U=n(0),F=n.n(U),E=n(1),N=function(e){var t=e.userItem,n=e.screenMode,o=Object(a.useState)(null),c=Object(s.a)(o,2),r=c[0],l=c[1];console.log("UserItem =>",t,n);var i=t.email?"".concat(t.email,"_").concat(t.profileId):"",d=JSON.parse(window.localStorage.getItem(i));if(d&&console.log("############ url cached",i),Object(a.useEffect)((function(){if(t.email)if(null===d){var e=Object(j.c)(h,"/profile_thumbnails/".concat(i,".png"));Object(j.a)(e).then((function(e){console.log("download_url=",e),window.localStorage.setItem(i,JSON.stringify(e)),l(e)}))}else l(d);else t.imageLinkBig?l(t.imageLinkBig):t.imageLink&&l(t.imageLink)}),[t,i,d]),console.log("UserItem render =>",r),r){var u=n===w?"BookImage":"UserImage";return Object(D.jsxs)("div",{children:[Object(D.jsx)("h6",{children:t.email?"".concat(t.email):"".concat(t.title)}),t.like?"".concat(t.like," \uc88b\uc544\uc694"):"".concat(t.read,"\uad8c \uc77d\uc74c"),Object(D.jsx)("br",{}),Object(D.jsx)("img",{src:r,className:u,alt:""})]})}return Object(D.jsx)("div",{})},A=function(e){var t=e.reviewItem;return console.log("ReviewItem =>",t),Object(D.jsx)("div",{className:"ReviewItem",children:Object(D.jsx)("h6",{children:t.bodyMessage})})},G=function(e){var t=new Date(e.getFullYear(),0,1),n=Math.floor((e-t)/864e5);return Math.floor((e.getDay()+1+n)/7)},T=function(){var e=Object(E.a)(F.a.mark((function e(t){var n,a,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,a="",o=null,t===m?a="UserRank/Rank_Day_".concat(n.getFullYear(),"_").concat(n.getMonth()+1,"_").concat(n.getDate(),"/Rank_Day_").concat(n.getFullYear(),"_").concat(n.getMonth()+1,"_").concat(n.getDate()):t===x?a="UserRank/Rank_Week_".concat(n.getFullYear(),"_").concat(G(n),"/Rank_Week_").concat(n.getFullYear(),"_").concat(G(n)):t===v?a="UserRank/Rank_Month_".concat(n.getFullYear(),"_").concat(n.getMonth()+1,"/Rank_Month_").concat(n.getFullYear(),"_").concat(n.getMonth()+1):t===I?a="ClientInfoDataBase":t===k?(a="ClientInfoDataBase",o=Object(d.f)(Object(d.a)(g,a),Object(d.g)("like",">",0),Object(d.e)("like","desc"),Object(d.d)(20))):t===w?a="Books":t===y&&(a="MessageDataBase",o=Object(d.f)(Object(d.a)(g,a),Object(d.e)("updatedDate","desc"),Object(d.d)(20))),console.log("query path = ",a),null===o&&(o=Object(d.f)(Object(d.a)(g,a),Object(d.g)("read",">",0),Object(d.e)("read","desc"),Object(d.d)(20))),e.next=8,Object(d.b)(o);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(a.useContext)(R),t=e.state,n=e.dispatch;console.log("UserList state=>",t);var o=t.mode,c=JSON.parse(window.localStorage.getItem(o));if(console.log("################ UserList render() userList=>",o,c),o!==m&&o!==v&&o!==x&&o!==I&&o!==k&&o!==w&&o!==y)return Object(D.jsx)("div",{className:"hidden"});if(!c)return console.log("try to download..."),function(e,t){T(e).then((function(n){var a=[];n.forEach((function(e){var t=e.data();a.push(t)})),window.localStorage.setItem(e,JSON.stringify(a)),t({type:S,userRankList:a})}))}(o,n),Object(D.jsx)("div",{children:Object(D.jsx)("h1",{children:"\ub370\uc774\ud0c0 \ub85c\ub529\uc911..."})});for(var r=[],s=0;s<c.length;){var l=c[s];if(o===y){var i=Object(D.jsx)(A,{reviewItem:l},""+s);r.push(i)}else{var d=Object(D.jsx)(N,{userItem:l,screenMode:o},""+s);r.push(d)}s+=1}return console.log("userItems=",r),Object(D.jsx)("div",{children:Object(D.jsx)("ul",{children:r})})},J=n(88),z=n(193),W=n(197),P=n(195),q=n(198),Q=n(196),V=n(188),K=n(104),Z=n.n(K),H=n(194),X=n(192),$=n(187),ee=n(190),te=n(181),ne=n(182),ae=[{mode:k,value:"\uc88b\uc740 \uae00\uc744 \uc4f0\ub294 \uce5c\uad6c\ub4e4"},{mode:w,value:"\uc778\uae30 \ub3c4\uc11c"},{mode:y,value:"\ub9ac\ubdf0"},{mode:m,value:"\uc624\ub298\uc758 \ub3c5\uc11c\uc655"},{mode:x,value:"\uc8fc\uac04 \ub3c5\uc11c\uc655"},{mode:v,value:"\uc6d4\uac04 \ub3c5\uc11c\uc655"},{mode:I,value:"\ubca0\uc2a4\ud2b8 \ub9ac\ub354"},{mode:"find-user",value:"\uce5c\uad6c \ucc3e\uae30"}],oe=["Profile","Account","Dashboard","Logout"],ce=function(e){var t=e.children,n=e.window,a=Object(te.a)({target:n?n():void 0});return Object(D.jsx)(ne.a,{appear:!1,direction:"down",in:!a,children:t})},re=function(e){var t=Object(a.useContext)(R),n=t.dispatch,o=t.logout;console.log("ResponsiveAppBar user=>",e);var c=e.user,r=Object(a.useState)(null),l=Object(s.a)(r,2),i=l[0],d=l[1],u=Object(a.useState)(null),b=Object(s.a)(u,2),g=b[0],O=b[1],f=Object(a.useState)(null),p=Object(s.a)(f,2),m=p[0],x=p[1],v=Object(a.useState)("\ucc9c\uad8c\uc77d\uae30"),k=Object(s.a)(v,2),w=k[0],y=k[1];Object(a.useEffect)((function(){if(c){var e="".concat(c.email),t=c.photoURL;if(console.log("ResponsiveAppBar downloadUrl=>",t),t)x(t);else{var n=Object(j.c)(h,"/profile_thumbnails/".concat(e,".png"));Object(j.a)(n).then((function(t){console.log("Me download_url=",t),window.localStorage.setItem(e,JSON.stringify(t)),x(t)}))}}}),[c]);var I=function(e){if(console.log("handleCloseNavMenu",e),d(null),"Logout"===e.target.innerText)return console.log("Logout~!!!"),O(null),x(""),void o(n);e.target.dataset.index?n({type:_,mode:e.target.dataset.index}):e.target.parentElement.dataset.index&&(y(e.target.innerText),n({type:_,mode:e.target.parentElement.dataset.index}))};return Object(D.jsx)(ce,Object(J.a)(Object(J.a)({},e),{},{children:Object(D.jsx)(z.a,{children:Object(D.jsx)(H.a,{maxWidth:"xl",children:Object(D.jsxs)(P.a,{disableGutters:!0,children:[Object(D.jsx)(Q.a,{variant:"h6",noWrap:!0,component:"div",sx:{mr:2,display:{xs:"none",md:"flex"}},children:"\ucc9c\uad8c\uc77d\uae30"}),Object(D.jsxs)(W.a,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[Object(D.jsx)(q.a,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){console.log("handleOpenNavMenu=>",e.currentTarget),d(e.currentTarget)},color:"inherit",children:Object(D.jsx)(Z.a,{})}),Object(D.jsx)(V.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(i),onClose:I,sx:{display:{xs:"block",md:"none"}},children:ae.map((function(e){return Object(D.jsx)(ee.a,{"data-index":e.mode,onClick:I,children:Object(D.jsx)(Q.a,{textAlign:"center",children:e.value})},e.mode)}))})]}),Object(D.jsx)(Q.a,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:w}),Object(D.jsx)(W.a,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:ae.map((function(e){return Object(D.jsx)(L.a,{"data-index":e.mode,onClick:I,sx:{my:2,color:"white",display:"block"},children:e.value},e.mode)}))}),Object(D.jsxs)(W.a,{sx:{flexGrow:0},children:[Object(D.jsx)($.a,{title:"Open settings",children:Object(D.jsx)(q.a,{onClick:function(e){console.log("handleOpenUserMenu=>",e.currentTarget),O(e.currentTarget)},sx:{p:0},children:Object(D.jsx)(X.a,{alt:"Remy Sharp",src:m})})}),Object(D.jsx)(V.a,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:g,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(g),onClose:function(){O(null)},children:oe.map((function(e){return Object(D.jsx)(ee.a,{onClick:I,children:Object(D.jsx)(Q.a,{textAlign:"center",children:e})},e)}))})]})]})})})}))},se=function(e){O.signOut().then((function(t){console.log("signed out~!!"),e({type:_,mode:p})})).catch((function(e){console.log("signed out failed~!!!",e)}))};var le=function(e){var t=Object(a.useReducer)(M,C,void 0),n=Object(s.a)(t,2),o=n[0],c=n[1];console.log("App state=>",o);var r=function(){var e=Object(a.useState)(null),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){var e=O.onAuthStateChanged((function(e){console.log("authUser=>",e),o(e||null)}));return function(){e()}}),[]),n}();return console.log("app render()...",r),Object(a.useEffect)((function(){c(null===r?{type:_,mode:p}:{type:_,mode:m})}),[r]),Object(D.jsx)(R.Provider,{value:{state:o,dispatch:c,logout:se},children:Object(D.jsxs)("div",{className:"App",children:[Object(D.jsx)(re,{props:e,user:r}),Object(D.jsx)(B,{}),Object(D.jsx)(Y,{})]})})},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,200)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),c(e),r(e)}))};n(137);r.a.render(Object(D.jsx)(o.a.StrictMode,{children:Object(D.jsx)(le,{})}),document.getElementById("root")),ie()}},[[138,1,2]]]);
//# sourceMappingURL=main.43d6e7e2.chunk.js.map